import { VULNERABILITIES } from "../bridge-constants";
import { type Vulnerability } from "../types";
import { findOrThrow } from "../utils/object";

/** Board Vulnerability from NS perspective */
export const BOARD_TO_VULNERABILITY: Record<number, Vulnerability> = {
  1: "NvNv",
  2: "VNv",
  3: "NvV",
  4: "VV",
  5: "VNv",
  6: "NvV",
  7: "VV",
  8: "NvNv",
  9: "NvV",
  10: "VV",
  11: "NvNv",
  12: "VNv",
  13: "VV",
  14: "NvNv",
  15: "VNv",
  0: "NvV",
};

/**
 * Calculates the vulnerability of the board from NS perspective
 * @param boardNumber Number of board
 * @returns Vulnerability of player on the specified board
 */
export function calculateVulnerability(boardNumber: number): Vulnerability {
  const board = boardNumber % VULNERABILITIES;
  return findOrThrow<number, Vulnerability>(
    BOARD_TO_VULNERABILITY,
    board,
    `Failed to calculate vulnerability of board number ${boardNumber}`
  );
}
